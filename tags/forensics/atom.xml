<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Writups - forensics</title>
    <subtitle>A diary dedicated to exploring the world of cybersecurity and technology.</subtitle>
    <link href="https://theanxiuser.github.io/writups/tags/forensics/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://theanxiuser.github.io/writups"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2024-10-23T00:00:00+00:00</updated>
    <id>https://theanxiuser.github.io/writups/tags/forensics/atom.xml</id>
    <entry xml:lang="en">
        <title>Investigating Windows - TryHackMe Writup</title>
        <published>2024-10-23T00:00:00+00:00</published>
        <updated>2024-10-23T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://theanxiuser.github.io/writups/chapters/investigating-windows/" type="text/html"/>
        <id>https://theanxiuser.github.io/writups/chapters/investigating-windows/</id>
        
        <content type="html">&lt;div style=&quot;display: flex; align-items: center;&quot;&gt;
  &lt;div&gt;
    &lt;img src=&quot;investigating_windows.png&quot; alt=&quot;Investigating Windows&quot; width=&quot;100&quot;&#x2F;&gt;
  &lt;&#x2F;div&gt;
  &lt;div style=&quot;margin-left: 10px;&quot;&gt;
    &lt;i&gt;A windows machine has been hacked, its your job to go investigate this windows machine and find clues to what the hacker might have done.&lt;&#x2F;i&gt;
  &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;
&lt;p&gt;Target IP: 10.10.99.65&lt;&#x2F;p&gt;
&lt;h3 id=&quot;1-version-and-year-of-windows-machine&quot;&gt;1. Version and year of windows machine&lt;&#x2F;h3&gt;
&lt;p&gt;This can be found easily through properties. Also there is command &lt;code&gt;Get-ComputerInfo -Property &amp;quot;Os*&amp;quot;&lt;&#x2F;code&gt; for powershell to get inforation. This is Windows S***** 20**&lt;&#x2F;p&gt;
&lt;h3 id=&quot;2-last-user-logged-in&quot;&gt;2. Last user logged in&lt;&#x2F;h3&gt;
&lt;p&gt;First need to get all the users through &lt;code&gt;Get-LocalUser&lt;&#x2F;code&gt;, we get&lt;&#x2F;p&gt;
&lt;pre&gt;
Name           Enabled Description
----           ------- -----------
Administrator  True    Built-in account for administering the computer&#x2F;domain
DefaultAccount False   A user account managed by the system.
Guest          True    Built-in account for guest access to the computer&#x2F;domain
Jenny          True
John           True
&lt;&#x2F;pre&gt;
&lt;p&gt;Now need to check the last login of each user, and found result as&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;theanxiuser.github.io&#x2F;writups&#x2F;chapters&#x2F;investigating-windows&#x2F;last_logon.png&quot; alt=&quot;alt text&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;3-when-did-john-log-onto-the-system-last&quot;&gt;3. When did John log onto the system last?&lt;&#x2F;h3&gt;
&lt;p&gt;We already have this answer in above question&lt;&#x2F;p&gt;
&lt;h3 id=&quot;4-what-ip-does-the-system-connect-to-when-it-first-starts&quot;&gt;4. What IP does the system connect to when it first starts?&lt;&#x2F;h3&gt;
&lt;p&gt;We need to check system startup connection by using registry editor.&lt;&#x2F;p&gt;
&lt;p&gt;The IP is found in path &lt;code&gt;HKEY_LOCAL_MACHINE &amp;gt; SOFTWARE &amp;gt; Microsoft &amp;gt; Windows &amp;gt; CurrentVersion &amp;gt; Run&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;5-what-two-accounts-had-administrative-privileges-other-than-the-administrator-user&quot;&gt;5. What two accounts had administrative privileges (other than the Administrator user)?&lt;&#x2F;h3&gt;
&lt;p&gt;We need to find out the user, that are the group member of group &lt;code&gt;Administrators&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;theanxiuser.github.io&#x2F;writups&#x2F;chapters&#x2F;investigating-windows&#x2F;admin_privileges.png&quot; alt=&quot;alt text&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;6-whats-the-name-of-the-scheduled-task-that-is-malicous&quot;&gt;6. Whats the name of the scheduled task that is malicous.&lt;&#x2F;h3&gt;
&lt;p&gt;Schedule task can be get using command &lt;code&gt;Get-ScheduledTask&lt;&#x2F;code&gt;. Now looking into taskpath &lt;code&gt;\&lt;&#x2F;code&gt;, we have only 6 tasks. By analyzing one task &lt;code&gt;Clean **** ******&lt;&#x2F;code&gt; seems to be malicious.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;7-what-file-was-the-task-trying-to-run-daily&quot;&gt;7. What file was the task trying to run daily?&lt;&#x2F;h3&gt;
&lt;p&gt;Need to find out the action done by this task. We can find out malicious binaries.&lt;&#x2F;p&gt;
&lt;pre&gt;
$task = Get-ScheduledTask | Where TaskName -EQ &quot;Clean **** ******&quot;
$task.Actions
&lt;&#x2F;pre&gt;
&lt;p&gt;Then we get the binary in Execute variable.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;8-what-port-did-this-file-listen-locally-for&quot;&gt;8. What port did this file listen locally for?&lt;&#x2F;h3&gt;
&lt;p&gt;As the file is using netcat, looking into the argument variable we have the port number &lt;code&gt;13**&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;9-when-did-jenny-last-logon&quot;&gt;9. When did Jenny last logon?&lt;&#x2F;h3&gt;
&lt;p&gt;We already have the answer.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;10-at-what-date-did-the-compromise-take-place&quot;&gt;10. At what date did the compromise take place?&lt;&#x2F;h3&gt;
&lt;p&gt;This is the malicious file creation date, look into the file properties of above executable file.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;11-during-the-compromise-at-what-time-did-windows-first-assign-special-privileges-to-a-new-logon&quot;&gt;11. During the compromise, at what time did Windows first assign special privileges to a new logon?&lt;&#x2F;h3&gt;
&lt;p&gt;Need to look into event viewer, of the file created date. Then looking into security log of that day. Open &lt;code&gt;Event Viewer&lt;&#x2F;code&gt; application and apply filter&#x2F;search. There from last, look for Task Category &lt;code&gt;Security Group Management&lt;&#x2F;code&gt; and we got the date and time.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;theanxiuser.github.io&#x2F;writups&#x2F;chapters&#x2F;investigating-windows&#x2F;event_viewer.png&quot; alt=&quot;alt text&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;12-what-tool-was-used-to-get-windows-passwords&quot;&gt;12. What tool was used to get Windows passwords?&lt;&#x2F;h3&gt;
&lt;p&gt;By looking into TMP directory, we can findout the tool and it is &lt;code&gt;mimi****&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;13-what-was-the-attackers-external-control-and-command-servers-ip&quot;&gt;13. What was the attackers external control and command servers IP?&lt;&#x2F;h3&gt;
&lt;p&gt;Also known as C2 server, used to control the attacker machine from remote area. Need to look into hosts file which is found in the location &lt;code&gt;C:\Windows\System32\drivers\etc&lt;&#x2F;code&gt;. At last of the file we got the IP address, wher edomain is set to goodle.com&lt;&#x2F;p&gt;
&lt;h3 id=&quot;14-what-was-the-extension-name-of-the-shell-uploaded-via-the-servers-website&quot;&gt;14. What was the extension name of the shell uploaded via the servers website?&lt;&#x2F;h3&gt;
&lt;p&gt;Shell should be uploaded via web, so need to look into webroot directory. Lets look into wwwroot dir.
This is in location &lt;code&gt;C:\inetpub\wwwroot&lt;&#x2F;code&gt;. The extension is found there.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;15-what-was-the-last-port-the-attacker-opened&quot;&gt;15. What was the last port the attacker opened?&lt;&#x2F;h3&gt;
&lt;p&gt;The port should be open for communication and can be found in firewall rule. Lets look into firewall configuration.&lt;&#x2F;p&gt;
&lt;p&gt;Inside Inbound Rules, there is a rule name &lt;code&gt;Allow outside connection for development&lt;&#x2F;code&gt;, looking into Protocols and Ports, we have the port opened by attacker as &lt;code&gt;13**&lt;&#x2F;code&gt;. &lt;&#x2F;p&gt;
&lt;h3 id=&quot;16-check-for-dns-poisoning-what-site-was-targeted&quot;&gt;16. Check for DNS poisoning, what site was targeted?&lt;&#x2F;h3&gt;
&lt;p&gt;We already have this answer in the hosts file, which is the domain name pointing to the attacker IP.&lt;&#x2F;p&gt;
&lt;p&gt;This CTF covered the simple forensics of a compromised windows server and backtrace to the attacker.&lt;&#x2F;p&gt;
&lt;p&gt;Happy Hacking !!&lt;&#x2F;p&gt;
</content>
        
    </entry>
</feed>
